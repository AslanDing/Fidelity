import os
os.environ['CUDA_VISIBLE_DEVICES'] = '3'
import torch
print(torch.cuda.is_available())
from ExplanationEvaluation.configs.selector import Selector
from ExplanationEvaluation.tasks.replication import replication,replication_sp,replication_sp_contrastive

import nni
from nni.utils import merge_parameter

_dataset = 'ba2motifs'      # One of: bashapes, bacommunity, treecycles, treegrids, ba2motifs, mutag
_explainer = 'pgexplainer' # One of: pgexplainer, gnnexplainer

# Parameters below should only be changed if you want to run any of the experiments in the supplementary
_folder = 'replication' # One of: replication, extension

# PGExplainer
config_path = f"./ExplanationEvaluation/configs/{_folder}/explainers/{_explainer}/{_dataset}.json"
print(config_path)
config = Selector(config_path)

nni_params = nni.get_next_parameter()
config.args.explainer = merge_parameter(config.args.explainer, nni_params)


extension = (_folder == 'extension')

# config.args.explainer.seeds = [0]

(auc, auc_std), inf_time = replication_sp_contrastive(config.args.explainer, extension,run_qual=False,results_store=False,extend=True)

print((auc, auc_std), inf_time)

nni.report_final_result(auc)

"""
ba-motifs
GNN 
fid plus  [0.20526425 0.2052926  0.20504062 0.20383985 0.19995231 0.19855002
 0.19425729 0.19211878 0.1831401  0.15486493 0.19790665] [5.08998145e-03 5.61248127e-03 4.78205085e-03 7.59004394e-03
 7.45571647e-03 5.11187860e-03 5.97733715e-03 4.11615135e-03
 4.90254641e-03 6.25818881e-03 2.07490309e-09]
fid minus  [0.21174074 0.21276388 0.21301655 0.21139189 0.21338571 0.21445925
 0.21932265 0.22027811 0.21556471 0.20328048 0.0650784 ] [6.09891830e-03 6.34242460e-03 5.56607375e-03 7.72989783e-03
 5.42011604e-03 5.14492191e-03 7.44289847e-03 5.07306098e-03
 4.98070191e-03 4.01129610e-03 3.06475265e-09]
fid label plus  [0.49   0.488  0.4825 0.4755 0.4675 0.465  0.4585 0.4605 0.4425 0.3725
 0.48  ] [1.02469508e-02 1.61554944e-02 1.18848643e-02 1.54029218e-02
 1.32759180e-02 1.02469508e-02 1.68893458e-02 9.06917857e-03
 1.28937970e-02 1.93971647e-02 1.11022302e-16]
fid label minus  [ 0.5055  0.507   0.4985  0.4975  0.4965  0.4935  0.484   0.4795  0.4965
  0.486  -0.01  ] [2.49449394e-02 2.27156334e-02 6.34428877e-03 1.63171689e-02
 1.43265488e-02 1.07354553e-02 8.88819442e-03 9.34077085e-03
 6.72681202e-03 2.50798724e-02 1.73472348e-18]
sparse  [0.50000962 0.53928589 0.59800643 0.63750065 0.69622116 0.74485
 0.79443592 0.84285643 0.89265062 0.94107116 0.78470129] [2.88461745e-05 1.11022302e-16 0.00000000e+00 1.11022302e-16
 1.11022302e-16 0.00000000e+00 1.11022302e-16 0.00000000e+00
 1.11022302e-16 0.00000000e+00 1.11022302e-16]
(0.6279919286631057, 0.007032682203981324) 510.1255142211914
[2023-06-14 11:42:46] Final result: 0.6279919286631057


pge
fid plus  [0.25015617 0.25135883 0.25241991 0.25444533 0.25880573 0.258257
 0.25427616 0.23017812 0.25417569 0.23360179 0.19662133] [2.24153412e-02 2.20966192e-02 1.95907233e-02 1.92437352e-02
 1.42140127e-02 1.27416098e-02 1.13783267e-02 1.04429086e-02
 9.18616933e-03 1.33145857e-02 2.50747184e-09]
fid minus  [0.10106552 0.10903299 0.12493612 0.12951233 0.15716387 0.17172886
 0.17691404 0.17489533 0.20370797 0.22406166 0.06507839] [7.41662819e-03 6.62555490e-03 6.43671133e-03 8.10387834e-03
 9.15604892e-03 9.91871242e-03 9.27226623e-03 7.46146497e-03
 9.95855827e-03 7.96874163e-03 4.52661862e-09]
fid label plus  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.] [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
fid label minus  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.] [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
sparse  [0.51388701 0.55184577 0.60569697 0.64345864 0.701401   0.7494522
 0.79641489 0.84485337 0.89556671 0.94727295 0.7843162 ] [0.00138865 0.00135649 0.00122414 0.0004596  0.00076533 0.00063467
 0.00067522 0.00046279 0.00051355 0.00218114 0.        ]
(0.6906811394479894, 0.05592417963463027) 8.243095302581787
[2023-06-13 12:50:24] Final result: 0.6906811394479894

"""

"""
ba-shape
GNN 
fid plus  [0.4926103  0.4926103  0.4926103  0.49253209 0.49247921 0.49247921
 0.49271529 0.49274879 0.49348206 0.49493519 0.47468867] [2.96208249e-04 2.96210393e-04 2.96208894e-04 2.39435097e-04
 2.39187426e-04 2.39188382e-04 8.52325880e-04 1.03756149e-03
 1.69195053e-03 2.32279126e-03 7.80380892e-09]
fid minus  [0.38926853 0.39673359 0.40478613 0.41134159 0.42811868 0.44655229
 0.47491719 0.4801092  0.47559208 0.4632163  0.49346322] [1.11904997e-02 1.06838771e-02 8.68836945e-03 8.22752636e-03
 7.99418616e-03 1.19890071e-02 1.06110262e-02 1.07655347e-02
 5.10088789e-03 7.04366123e-03 6.86927549e-09]
fid label plus  [0.98333333 0.98333333 0.98333333 0.98333333 0.98333333 0.98333333
 0.98333333 0.98333333 0.98333333 0.98333333 0.98333333] [1.11022302e-16 1.11022302e-16 1.11022302e-16 1.11022302e-16
 1.11022302e-16 1.11022302e-16 1.11022302e-16 1.11022302e-16
 1.11022302e-16 1.11022302e-16 1.11022302e-16]
fid label minus  [0.27       0.29833333 0.32666667 0.38166667 0.46166667 0.53833333
 0.67833333 0.735      0.825      0.89       0.98333333] [5.25991128e-02 4.62180821e-02 3.74165739e-02 3.11359028e-02
 3.94757309e-02 4.34932945e-02 4.01732360e-02 4.24591307e-02
 3.67045259e-02 3.09120617e-02 1.11022302e-16]
sparse  [0.5        0.54917458 0.59925298 0.64909949 0.69915201 0.74962115
 0.79925617 0.84926007 0.8991552  0.94918499 0.988657  ] [0.00000000e+00 0.00000000e+00 1.11022302e-16 0.00000000e+00
 1.11022302e-16 4.61250544e-06 1.11022302e-16 0.00000000e+00
 0.00000000e+00 1.11022302e-16 0.00000000e+00]
(0.8844279876326306, 0.0020442918315762126) 127.14838556448619

pge
fid plus  [0.49346321 0.49346322 0.49346321 0.49346322 0.49346321 0.49346322
 0.49346322 0.49346322 0.49346321 0.50551239 0.47468867] [6.58467235e-09 5.66706875e-09 6.33450292e-09 7.83744576e-09
 6.12661463e-09 7.37971138e-09 6.45525917e-09 7.75655975e-09
 6.09755160e-09 1.50180736e-03 6.58223645e-09]
fid minus  [0.4308962  0.43702012 0.44232923 0.44673349 0.44959469 0.4523018
 0.45548216 0.46165291 0.46571919 0.47233542 0.49346322] [1.87466680e-02 1.95772469e-02 2.06449676e-02 2.10438816e-02
 2.04424387e-02 1.96565552e-02 1.73753874e-02 1.33528580e-02
 9.99552333e-03 4.66210612e-03 7.45786206e-09]
fid label plus  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.] [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
fid label minus  [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.] [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
sparse  [0.5        0.54917458 0.59925298 0.64910128 0.69915201 0.74962281
 0.79925617 0.84926144 0.8991552  0.94918499 0.988657  ] [0.00000000e+00 0.00000000e+00 1.11022302e-16 5.39958477e-06
 1.11022302e-16 9.57846642e-06 1.11022302e-16 4.10526991e-06
 0.00000000e+00 1.11022302e-16 0.00000000e+00]
(0.9994827049170916, 6.98974389065308e-05) 40.54519188404083
[2023-06-13 14:46:58] Final result: 0.9994827049170916


"""


"""

fid_plus_mean [0.2594159  0.25694924 0.25637841 0.25681989 0.25590522 0.23388346
 0.22542423 0.22431711 0.21128529 0.19516732 0.19894105]
fid_minus_mean [-0.00904839  0.00720503  0.04086815  0.0671862   0.12076153  0.15469326
  0.16037407  0.19343407  0.17810924  0.20336435  0.05472511]
fid_plus_label_mean [0.48  0.48  0.48  0.48  0.48  0.475 0.49  0.47  0.475 0.45  0.485]
fid_minus_label_mean [0.085 0.125 0.21  0.275 0.39  0.48  0.48  0.48  0.475 0.48  0.48 ]
sparsity_mean [0.51364925 0.55163577 0.60671569 0.64319647 0.70066399 0.74996187
 0.7967316  0.84454363 0.89489948 0.94259207 0.7843162 ]
 
 fid_plus_mean [0.21264743 0.21462555 0.21281198 0.21217097 0.21048958 0.2049222
 0.20074804 0.1880799  0.19485865 0.19044259 0.20021665]
fid_minus_mean [0.14143964 0.1435946  0.14141273 0.14740857 0.15993662 0.17674222
 0.19120303 0.19421722 0.17897056 0.16687199 0.13209435]
fid_plus_label_mean [0.47  0.48  0.455 0.46  0.46  0.4   0.41  0.425 0.42  0.44  0.495]
fid_minus_label_mean [ 0.09   0.155  0.11   0.145  0.215  0.325  0.425  0.515  0.39   0.28
 -0.01 ]
 
 fid_plus_mean [0.20958799 0.20898191 0.20866161 0.20827026 0.20672987 0.20674315
 0.20744795 0.20213981 0.21954351 0.18130618 0.20129688]
fid_minus_mean [0.19821819 0.1997536  0.20187989 0.20167817 0.20182429 0.20457017
 0.19989687 0.19730936 0.18497347 0.18669118 0.17433338]
fid_plus_label_mean [0.48  0.48  0.48  0.48  0.48  0.48  0.485 0.48  0.56  0.395 0.48 ]
fid_minus_label_mean [0.48 0.48 0.48 0.48 0.48 0.48 0.48 0.48 0.48 0.48 0.48]
sparsity_mean [0.51344541 0.55163577 0.60671569 0.64319647 0.70066399 0.74996572
 0.7967316  0.84454363 0.89490333 0.94259207 0.7843162 ]
 
 fid_plus_mean [0.23808923 0.23648273 0.23374663 0.22944816 0.23182963 0.22666876
 0.22316589 0.20149585 0.20291819 0.16952688 0.20497458]
fid_minus_mean [0.17443564 0.1780106  0.19077455 0.19035718 0.19661584 0.2008118
 0.18318295 0.18321358 0.2025665  0.21203209 0.11643675]
fid_plus_label_mean [0.72  0.715 0.685 0.675 0.655 0.62  0.625 0.485 0.47  0.38  0.52 ]
fid_minus_label_mean [ 0.46   0.455  0.445  0.45   0.47   0.525  0.475  0.42   0.465  0.48
 -0.01 ]
sparsity_mean [0.51344541 0.55163577 0.60661953 0.64319647 0.70056399 0.74986572
 0.7967316  0.84454363 0.89480333 0.94259207 0.7843162 ]
 
 
 fid_plus_mean [0.21068314 0.212563   0.20941172 0.20979465 0.20893005 0.19368689
 0.19004422 0.18853625 0.19187618 0.19843421 0.20137848]
fid_minus_mean [0.08061066 0.08344699 0.08605678 0.09720683 0.12060683 0.15042305
 0.17200056 0.19313797 0.14959574 0.15288717 0.07056463]
fid_plus_label_mean [0.46  0.475 0.465 0.455 0.46  0.39  0.39  0.43  0.42  0.44  0.49 ]
fid_minus_label_mean [ 0.125  0.12   0.1    0.125  0.175  0.275  0.35   0.435  0.315  0.28
 -0.01 ]
sparsity_mean [0.51334925 0.55163577 0.60671569 0.64319647 0.70066399 0.74996187
 0.7967316  0.84454363 0.89480333 0.94259207 0.7843162 ]
 
"""


"""
src + retraining gt acc = 1.0 
fid_plus_mean [0.23791707 0.23774553 0.2373673  0.23494756 0.23120963 0.22653369
 0.22067348 0.19946083 0.20774271 0.20185415 0.19884843]
fid_minus_mean [0.18080022 0.18331711 0.1857673  0.18718523 0.19031848 0.19950509
 0.20931183 0.20119582 0.17503927 0.18495103 0.13660662]
fid_plus_label_mean [0.88  0.881 0.889 0.881 0.853 0.827 0.764 0.527 0.564 0.384 0.496]
fid_minus_label_mean [ 0.348  0.389  0.451  0.452  0.403  0.482  0.498  0.495  0.454  0.494
 -0.006]
sparsity_mean [0.51384453 0.55081836 0.60620578 0.64426181 0.70111472 0.74947265
 0.79681244 0.84461462 0.89507867 0.94299681 0.78364295]
score: 0.6573321494566433
"""

"""
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9962, Val Acc: 1.0000, Test Acc: 0.9900.
Run 0 with seed 0
100%|██████████| 150/150 [05:05<00:00,  2.03s/it]
100%|██████████| 1000/1000 [01:32<00:00, 10.85it/s]
fid_plus_mean [0.20864743 0.20893716 0.20730643 0.20561251 0.20541093 0.20117253
 0.20102622 0.19198218 0.21705272 0.20411558 0.20016256]
fid_minus_mean [0.20241468 0.20272219 0.20332491 0.20416101 0.20454128 0.20607138
 0.2021593  0.19852884 0.19015161 0.19993846 0.17247481]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.488 0.571 0.427 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5138453  0.55079682 0.60634424 0.64424181 0.70109472 0.74943265
 0.79683244 0.84467385 0.8951379  0.94301604 0.78364295]
score: 0.6574627069106854
"""

"""
ba2motifs_500_reg_ce_loop_inter_explain_sp2_5.pth
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9950, Val Acc: 0.9900, Test Acc: 1.0000.
Run 0 with seed 0
100%|██████████| 150/150 [05:09<00:00,  2.07s/it]
100%|██████████| 1000/1000 [01:44<00:00,  9.60it/s]
fid_plus_mean [0.20472773 0.20604549 0.20469706 0.20246163 0.20226565 0.19743323
 0.19987568 0.18742192 0.22077959 0.19063433 0.20044956]
fid_minus_mean [0.20707713 0.20608796 0.20566513 0.20542613 0.20387407 0.20538614
 0.20287372 0.20057562 0.19001698 0.19863843 0.1666072 ]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.489 0.572 0.428 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5138053  0.55083759 0.60632501 0.64430181 0.70107549 0.74947265
 0.79683244 0.84461462 0.89515637 0.94301604 0.78364295]
Backend TkAgg is interactive backend. Turning interactive mode on.
score: 0.657457011451281

"""

"""
ba2_explain_posneg
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9925, Val Acc: 0.9800, Test Acc: 0.9800.
fid_plus_mean [0.20785162 0.20836452 0.20612137 0.20387237 0.20317123 0.19836543
 0.19963961 0.18880151 0.21670641 0.20900083 0.20036634]
fid_minus_mean [0.20406323 0.20388805 0.2048926  0.20581969 0.20582148 0.20833913
 0.20541852 0.20192426 0.19290277 0.20022429 0.17425352]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.489 0.57  0.586 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5137653  0.55073682 0.60622578 0.64422181 0.70109472 0.74947188
 0.7968709  0.84461462 0.89511867 0.94303604 0.78364295]
score: 0.6575312471401005
"""

"""
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 1.0000.
Run 0 with seed 0
100%|██████████| 150/150 [04:35<00:00,  1.84s/it]
100%|██████████| 1000/1000 [01:28<00:00, 11.35it/s]
fid_plus_mean [0.20568703 0.20655954 0.2034291  0.20030493 0.20128112 0.19231543
 0.19170728 0.17977203 0.2086663  0.1886847  0.20009117]
fid_minus_mean [0.22101837 0.21996874 0.21903472 0.21756916 0.21356694 0.21055114
 0.20184316 0.2007686  0.19431468 0.20266733 0.18894131]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.488 0.561 0.376 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5138053  0.55083759 0.60628501 0.64426181 0.70107549 0.74947265
 0.79683244 0.84461462 0.89515637 0.94301604 0.78364295]
score: 0.6574570601304212

"""

"""
ba2motifs_1000_reg_ce_loop_inter_intra_posneg
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9975, Val Acc: 1.0000, Test Acc: 0.9900.
Run 0 with seed 0
100%|██████████| 150/150 [05:25<00:00,  2.17s/it]
100%|██████████| 1000/1000 [01:39<00:00, 10.04it/s]
fid_plus_mean [0.20792051 0.20833995 0.20665812 0.20429804 0.20358757 0.19862974
 0.20027294 0.18834025 0.2182832  0.17934529 0.20018435]
fid_minus_mean [0.20495045 0.2049155  0.20518853 0.20517129 0.20425838 0.20490013
 0.20148132 0.19900815 0.19385329 0.1998493  0.17123652]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.492 0.577 0.407 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5137853  0.55079836 0.60626655 0.64434181 0.70103549 0.74949111
 0.7968709  0.84463462 0.89517714 0.94301681 0.78364295]
score: 0.6576440853871064


ba2motifs_1000_reg_ce_loop_inter_explain_posneg
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9925, Val Acc: 0.9700, Test Acc: 0.9900.
Run 0 with seed 0
100%|██████████| 150/150 [04:56<00:00,  1.98s/it]
100%|██████████| 1000/1000 [01:31<00:00, 10.90it/s]
fid_plus_mean [0.21074807 0.21133993 0.2092042  0.20695888 0.20561368 0.20062342
 0.20186655 0.18975584 0.2168338  0.20296996 0.20037754]
fid_minus_mean [0.20127068 0.20119351 0.20260336 0.20317885 0.20219967 0.2045653
 0.20394732 0.20051144 0.19281551 0.1991585  0.16909265]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.489 0.571 0.58  0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.51384453 0.55089451 0.60626578 0.64428181 0.70111395 0.74945265
 0.79687167 0.84467385 0.89515637 0.94297681 0.78364295]
score: 0.657465627659098

ba2motifs_100_reg_CE_loop_inter_3_spectral_pooling
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9550, Val Acc: 0.9400, Test Acc: 0.9300.
fid_plus_mean [0.20574743 0.20666792 0.20481971 0.20247483 0.20275395 0.19649421
 0.19796565 0.18452882 0.22607203 0.22169844 0.20001074]
fid_minus_mean [0.20402041 0.20418434 0.20549138 0.20566943 0.2054196  0.20759867
 0.20334313 0.20203993 0.19504268 0.19975011 0.18403244]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.495 0.596 0.658 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.51380453 0.55081759 0.60626655 0.64438181 0.70103549 0.74949111
 0.7969109  0.84467462 0.89513867 0.94295558 0.78364295]
score: 0.6576439393496856

ba2motifs_1000_reg_ce_loop_inter_explain_sp2_4
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9925, Val Acc: 0.9700, Test Acc: 0.9800.
Run 0 with seed 0
fid_plus_mean [0.20762687 0.20787439 0.20555342 0.20303692 0.20315713 0.19784877
 0.19955149 0.18860058 0.22122646 0.18454972 0.20047106]
fid_minus_mean [0.19696132 0.19638454 0.1960983  0.19699565 0.19735898 0.20138015
 0.20226694 0.20002983 0.19492492 0.20061361 0.16256098]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.491 0.572 0.429 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.51382453 0.55077913 0.60622655 0.64428181 0.70115318 0.74941265
 0.79681244 0.84467231 0.8952356  0.94299681 0.78364295]
score: 0.657330883798998

"""

"""
mutag_inter_explain_posneg

This model obtained: Train Acc: 0.8204, Val Acc: 0.8249, Test Acc: 0.8134.
This model obtained: Train Acc: 0.8141, Val Acc: 0.8180, Test Acc: 0.8041.
Loading MUTAG dataset, this can take a while
Loading MUTAG groundtruth, this can take a while
Run 0 with seed 0
100%|██████████| 30/30 [06:02<00:00, 12.08s/it]
100%|██████████| 4337/4337 [12:31<00:00,  5.77it/s]
fid_plus_mean [0.18815345 0.18801311 0.18801132 0.18739096 0.18681171 0.18412801
 0.18162976 0.1809586  0.17727891 0.16893663 0.05534029]
fid_minus_mean [0.1753552  0.17544848 0.1754676  0.17566309 0.17634118 0.17826716
 0.18209727 0.185528   0.19299473 0.20500331 0.23095068]
fid_plus_label_mean [0.27000231 0.26977173 0.26954116 0.26815771 0.26677427 0.2646991
 0.26285451 0.26100991 0.25340097 0.25178695 0.05395435]
fid_minus_label_mean [0.25916532 0.25962647 0.25962647 0.25985704 0.25962647 0.2584736
 0.26077934 0.26077934 0.25547614 0.25893475 0.28683422]
sparsity_mean [0.87372554 0.87384327 0.87386754 0.87406363 0.87489934 0.87673571
 0.8803067  0.88909781 0.91163922 0.95146053 0.99620966]
score: 0.5635420423924805


mutag_original

This model obtained: Train Acc: 0.8204, Val Acc: 0.8249, Test Acc: 0.8134.
Loading MUTAG dataset, this can take a while
Loading MUTAG groundtruth, this can take a while
Run 0 with seed 0
100%|██████████| 30/30 [05:37<00:00, 11.24s/it]
100%|██████████| 4337/4337 [11:19<00:00,  6.38it/s]
fid_plus_mean [0.16594834 0.16590789 0.16592395 0.16539419 0.16492706 0.16456275  0.16376138 0.16323002 0.16230877 0.15841496 0.06155767]
fid_minus_mean [0.12798668 0.1280114  0.12804686 0.12844038 0.12911197 0.13069572  0.13475442 0.14011835 0.16668551 0.204605   0.25323129]
fid_plus_label_mean [0.22319576 0.22319576 0.22319576 0.22227346 0.22273461 0.22365691  0.22504035 0.22181231 0.21166705 0.19414342 0.07562831]
fid_minus_label_mean [0.17523634 0.17500576 0.17523634 0.17523634 0.17523634 0.17316117  0.17592806 0.18169241 0.21627853 0.26977173 0.33617708]
sparsity_mean [0.87372554 0.87384327 0.87386754 0.87406363 0.87489211 0.87673671  0.88029894 0.88910726 0.91163646 0.95146674 0.99620966]
score: 0.5635418434788143

mutag_original new training 
This model obtained: Train Acc: 0.8204, Val Acc: 0.8249, Test Acc: 0.8134.
This model obtained: Train Acc: 0.8011, Val Acc: 0.8295, Test Acc: 0.7972.
Loading MUTAG dataset, this can take a while
Loading MUTAG groundtruth, this can take a while
Run 0 with seed 0
100%|██████████| 30/30 [05:48<00:00, 11.61s/it]
100%|██████████| 4337/4337 [10:32<00:00,  6.86it/s]
fid_plus_mean [0.21645515 0.21643824 0.21642203 0.21634994 0.21679854 0.21820427
 0.22052524 0.21776577 0.20752996 0.20161708 0.08209801]
fid_minus_mean [0.11538906 0.11543423 0.11544653 0.1158205  0.11635338 0.11833883
 0.12232495 0.12917938 0.15941305 0.2031875  0.24804037]
fid_plus_label_mean [0.22250404 0.22273461 0.22273461 0.22273461 0.22319576 0.2264238
 0.23241872 0.22919068 0.21328107 0.22780724 0.06871109]
fid_minus_label_mean [0.11897625 0.11897625 0.11897625 0.12012912 0.11920682 0.12128199
 0.12404888 0.13580816 0.19045423 0.2637768  0.35439244]
sparsity_mean [0.87372554 0.87384327 0.87386754 0.87406363 0.87489664 0.87673854
 0.880316   0.88909969 0.91163775 0.95146681 0.99620966]
score: 0.5635420423924806

ba2motifs_300_inter_explain_mcl
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9975, Val Acc: 0.9800, Test Acc: 0.9900.
Run 0 with seed 0
100%|██████████| 150/150 [11:23<00:00,  4.55s/it]
100%|██████████| 1000/1000 [04:41<00:00,  3.55it/s]
fid_plus_mean [0.20462625 0.20525903 0.20333936 0.20105295 0.20130722 0.19604922
 0.19827627 0.18748513 0.22591668 0.18673474 0.20017876]
fid_minus_mean [0.20656541 0.20647231 0.20685496 0.20676748 0.20556754 0.20589529
 0.20185652 0.20007873 0.19389271 0.20085452 0.17704047]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.49  0.57  0.422 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.51386453 0.55073836 0.60620578 0.64422258 0.70111472 0.74941265
 0.79687167 0.84467308 0.89531406 0.94301604 0.78364295]
score: 0.6573674905124356
"""



"""
ori
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
Run 0 with seed 0
100%|██████████| 150/150 [05:02<00:00,  2.02s/it]
100%|██████████| 1000/1000 [01:34<00:00, 10.62it/s]
fid_plus_mean [0.20583896 0.20656294 0.20481322 0.20246167 0.20230425 0.19701184
 0.19837277 0.18717722 0.2198045  0.21758876 0.20016812]
fid_minus_mean [0.20598805 0.20619284 0.20696531 0.20722491 0.20628964 0.207337
 0.20317483 0.20200912 0.19761751 0.20129306 0.18620516]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.491 0.576 0.589 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5138453  0.55077913 0.60624578 0.64428181 0.70111472 0.74947111
 0.79683167 0.84461462 0.89511714 0.94299681 0.78364295]
 
 ba2motifs_900_inter_explain_sp2_4_70_
 This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9775, Val Acc: 0.9200, Test Acc: 0.9600.
Run 0 with seed 0
100%|██████████| 150/150 [05:52<00:00,  2.35s/it]
100%|██████████| 1000/1000 [01:43<00:00,  9.67it/s]
fid_plus_mean [0.20268653 0.20366706 0.20198761 0.19957393 0.19921238 0.19489989
 0.1993405  0.18560495 0.23030753 0.23108346 0.20015992]
fid_minus_mean [0.2116811  0.21099679 0.21162977 0.21074557 0.209344   0.20857987
 0.20364972 0.20224345 0.19464005 0.20028609 0.18987588]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.492 0.578 0.64  0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5138253  0.55075989 0.60626501 0.64424181 0.70111472 0.74947111
 0.79683167 0.84461462 0.89513714 0.94301604 0.78364295]
score: 0.6573466558404258

ba2motifs_1000_reg_ce_loop_inter_explain_mcl
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9912, Val Acc: 0.9600, Test Acc: 0.9900.
Run 0 with seed 0
100%|██████████| 150/150 [05:36<00:00,  2.24s/it]
100%|██████████| 1000/1000 [01:34<00:00, 10.55it/s]
fid_plus_mean [0.20456485 0.20567546 0.20482061 0.20294893 0.20196424 0.19891744
 0.20334428 0.19063488 0.2283903  0.19236619 0.20030423]
fid_minus_mean [0.20460876 0.20439583 0.20531224 0.2052299  0.20382965 0.2051832
 0.20320497 0.2017399  0.1923095  0.19857927 0.17609833]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.502 0.492 0.579 0.424 0.494]
fid_minus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.494]
sparsity_mean [0.5138453  0.55077913 0.60622655 0.64428181 0.70111472 0.74947111
 0.79683167 0.84461462 0.89511714 0.94299681 0.78364295]
score: 0.6573482135729125
"""



""""
ba2motifs_100_inter_explain1t_sp2_4_70_
ba2motifs_100_inter_explain1t_sp2_4_70_
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 1.0000.
Run 0 with seed 0
100%|██████████| 150/150 [06:02<00:00,  2.42s/it]
100%|██████████| 1000/1000 [01:49<00:00,  9.10it/s]
fid_plus_mean [0.20076177 0.20089105 0.20077901 0.20074897 0.20079639 0.20062153
 0.20032565 0.19934574 0.20053541 0.19603298 0.20037547]
fid_minus_mean [0.10737578 0.10961275 0.11532267 0.12335758 0.14060149 0.17913879
 0.20181095 0.20138193 0.19948234 0.20039318 0.14094751]
fid_plus_label_mean [0.494 0.494 0.494 0.494 0.494 0.494 0.494 0.49  0.489 0.467 0.494]
fid_minus_label_mean [ 0.007  0.017  0.047  0.068  0.139  0.321  0.494  0.494  0.494  0.494
 -0.006]
sparsity_mean [0.5138653  0.55075836 0.60626501 0.64430181 0.70109472 0.74943188
 0.79689248 0.84469231 0.8951379  0.94301604 0.78364295]
score: 0.6573450007496587

ba2motifs_200_inter_explain1t_sp2_4_70__
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9950, Val Acc: 0.9800, Test Acc: 0.9900.
  0%|          | 0/150 [00:00<?, ?it/s]Run 0 with seed 0
100%|██████████| 150/150 [07:10<00:00,  2.87s/it]
100%|██████████| 1000/1000 [04:48<00:00,  3.47it/s]
fid_plus_mean [0.20079541 0.20098395 0.20109192 0.20099654 0.20051141 0.19981649
 0.19896323 0.1952982  0.19228838 0.1886003  0.20013384]
fid_minus_mean [0.17359526 0.17435782 0.17688106 0.17912751 0.18424325 0.19587871
 0.20407923 0.20186072 0.20091906 0.20043013 0.18236972]
fid_plus_label_mean [0.509 0.526 0.532 0.515 0.514 0.483 0.445 0.282 0.526 0.42  0.48 ]
fid_minus_label_mean [ 0.124  0.127  0.142  0.152  0.185  0.338  0.483  0.535  0.524  0.494
 -0.006]
sparsity_mean [0.5138453  0.55077836 0.60626578 0.64434258 0.70113318 0.74943188
 0.79677244 0.84467308 0.89519714 0.94299681 0.78364295]
score: 0.6573490411182961


ba2motifs_1000_explain_ce
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 1.0000, Val Acc: 0.9900, Test Acc: 1.0000.
Run 0 with seed 0
100%|██████████| 150/150 [00:00<00:00, 2476951.18it/s]
100%|██████████| 1000/1000 [01:40<00:00,  9.93it/s]
fid_plus_mean [0.22018817 0.2221884  0.22288512 0.22063407 0.21889438 0.21889123
 0.21430818 0.20507362 0.19699954 0.19224499 0.20009872]
fid_minus_mean [-0.00215344  0.00299701  0.01905311  0.03419895  0.06827252  0.10338534
  0.13306105  0.16669168  0.1717056   0.1527002  -0.02937258]
fid_plus_label_mean [0.495 0.494 0.493 0.49  0.488 0.483 0.48  0.469 0.448 0.46  0.494]
fid_minus_label_mean [ 0.034  0.043  0.056  0.067  0.103  0.181  0.299  0.489  0.496  0.494
 -0.006]
sparsity_mean [0.51557943 0.55278022 0.60809655 0.64621674 0.70389099 0.75122255
 0.79957067 0.84760259 0.89644143 0.9452266  0.78364295]
score: 0.518791803211655


max subgraphs
ba2motifs_80_inter_explain1t_sp2_4_70_maxsub
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 1.0000.
Run 0 with seed 0
fid_plus_mean [0.18298227 0.18318349 0.18206122 0.18014138 0.17784876 0.17972535
 0.18265018 0.18168885 0.17815553 0.16999628 0.20000845]
fid_minus_mean [0.10046187 0.10977349 0.12967488 0.14683466 0.1744321  0.19824075
 0.20560298 0.20652939 0.20227021 0.19953035 0.0985571 ]
fid_plus_label_mean [0.493 0.493 0.491 0.483 0.477 0.469 0.475 0.48  0.477 0.431 0.494]
fid_minus_label_mean [ 0.05   0.082  0.159  0.235  0.359  0.461  0.494  0.494  0.494  0.494
 -0.006]
sparsity_mean [0.51561789 0.55280022 0.60811578 0.64619674 0.70389099 0.75126024
 0.79960874 0.84758259 0.89646143 0.94524542 0.78364295]
score: 0.5187917545325148

ba2motifs_200_inter_explain1t_sp2_4_70__maxsub
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 1.0000.
Run 0 with seed 0
fid_plus_mean [0.15720481 0.15456524 0.15354943 0.15348726 0.15382237 0.15413336
 0.14279482 0.1384624  0.1351788  0.1606564  0.20007756]
fid_minus_mean [0.15828939 0.16236443 0.17092883 0.17785797 0.18914254 0.19787006
 0.20057174 0.20036333 0.20029968 0.20020699 0.15795109]
fid_plus_label_mean [0.492 0.492 0.493 0.49  0.487 0.48  0.475 0.459 0.411 0.419 0.494]
fid_minus_label_mean [ 0.07   0.103  0.178  0.251  0.373  0.471  0.502  0.501  0.495  0.494
 -0.006]
sparsity_mean [0.51561789 0.55280022 0.60807732 0.64619674 0.70389099 0.75126024
 0.79958951 0.84758259 0.89646143 0.94524542 0.78364295]
score: 0.518791803211655


ba2motifs_60_explain_ce_max
ba2motifs_60_explain_ce_max
This model obtained: Train Acc: 1.0000, Val Acc: 1.0000, Test Acc: 0.9900.
This model obtained: Train Acc: 0.9988, Val Acc: 1.0000, Test Acc: 0.9900.
Run 0 with seed 0
fid_plus_mean [0.20069091 0.20128556 0.19832458 0.19445338 0.1878354  0.18428723
 0.17910881 0.16128737 0.16117177 0.18765637 0.19959804]
fid_minus_mean [0.0917399  0.10300495 0.12476907 0.14307108 0.17372214 0.20185595
 0.21248934 0.21346341 0.19954334 0.19584794 0.06385038]
fid_plus_label_mean [0.493 0.493 0.493 0.491 0.49  0.484 0.485 0.479 0.47  0.467 0.494]
fid_minus_label_mean [ 0.046  0.078  0.16   0.24   0.36   0.462  0.494  0.494  0.494  0.494
 -0.006]
sparsity_mean [0.51561789 0.55280022 0.60811578 0.64617674 0.70389099 0.75124024
 0.79960874 0.84758259 0.89642143 0.94522619 0.78364295]
score: 0.518791803211655
"""

